{"ast":null,"code":"import axios from \"axios\";\n\n// כתובת הבסיס ל־API שלך\naxios.defaults.baseURL = \"http://localhost:5246\";\n\n// ✅ Interceptor שמוסיף את ה־Token אוטומטית לכל בקשה\naxios.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\"); // הטוקן נשמר בלוקל סטורג' אחרי login/register\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// ✅ Interceptor שתופס שגיאות 401 (לא מאומת) ומפנה לעמוד login\naxios.interceptors.response.use(response => response, error => {\n  if (error.response && error.response.status === 401) {\n    window.location.href = \"/login\";\n  }\n  return Promise.reject(error);\n});\n\n// ✅ פונקציות ההזדהות\nconst authService = {\n  register: async (userName, password) => {\n    const response = await axios.post(\"/api/auth/register\", {\n      userName,\n      passwordHash: password // השרת יחשב את ה־Hash בעצמו\n    });\n    const {\n      token\n    } = response.data;\n    if (token) localStorage.setItem(\"token\", token);\n    return response.data;\n  },\n  login: async (userName, password) => {\n    const response = await axios.post(\"/api/auth/login\", {\n      userName,\n      passwordHash: password\n    });\n    const {\n      token\n    } = response.data;\n    if (token) localStorage.setItem(\"token\", token);\n    return response.data;\n  },\n  logout: () => {\n    localStorage.removeItem(\"token\");\n  }\n};\n\n// ✅ פונקציות CRUD של המשימות\nconst todoService = {\n  getTasks: async () => {\n    const response = await axios.get(\"/api/items\");\n    return response.data;\n  },\n  getTaskById: async id => {\n    const response = await axios.get(`/api/items/${id}`);\n    return response.data;\n  },\n  addTask: async name => {\n    const newTask = {\n      name,\n      isComplete: false\n    };\n    const response = await axios.post(\"/api/items\", newTask);\n    return response.data;\n  },\n  updateTask: async (id, name, isComplete) => {\n    const response = await axios.put(`/api/items/${id}`, {\n      id,\n      name,\n      isComplete\n    });\n    return response.data;\n  },\n  deleteTask: async id => {\n    const response = await axios.delete(`/api/items/${id}`);\n    return response.data;\n  }\n};\n\n// מייצאים את שני השירותים: auth ו־todo\nexport default {\n  ...authService,\n  ...todoService\n};","map":{"version":3,"names":["axios","defaults","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","response","error","status","window","location","href","Promise","reject","authService","register","userName","password","post","passwordHash","data","setItem","login","logout","removeItem","todoService","getTasks","get","getTaskById","id","addTask","name","newTask","isComplete","updateTask","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות ו/פרקטיקוד/פרקטיקוד 3 ב/ToDoListReact-master/src/service.js"],"sourcesContent":["import axios from \"axios\";\n\n// כתובת הבסיס ל־API שלך\naxios.defaults.baseURL = \"http://localhost:5246\";\n\n// ✅ Interceptor שמוסיף את ה־Token אוטומטית לכל בקשה\naxios.interceptors.request.use((config) => {\n  const token = localStorage.getItem(\"token\"); // הטוקן נשמר בלוקל סטורג' אחרי login/register\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// ✅ Interceptor שתופס שגיאות 401 (לא מאומת) ומפנה לעמוד login\naxios.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response && error.response.status === 401) {\n      window.location.href = \"/login\";\n    }\n    return Promise.reject(error);\n  }\n);\n\n// ✅ פונקציות ההזדהות\nconst authService = {\n  register: async (userName, password) => {\n    const response = await axios.post(\"/api/auth/register\", {\n      userName,\n      passwordHash: password, // השרת יחשב את ה־Hash בעצמו\n    });\n    const { token } = response.data;\n    if (token) localStorage.setItem(\"token\", token);\n    return response.data;\n  },\n\n  login: async (userName, password) => {\n    const response = await axios.post(\"/api/auth/login\", {\n      userName,\n      passwordHash: password,\n    });\n    const { token } = response.data;\n    if (token) localStorage.setItem(\"token\", token);\n    return response.data;\n  },\n\n  logout: () => {\n    localStorage.removeItem(\"token\");\n  },\n};\n\n// ✅ פונקציות CRUD של המשימות\nconst todoService = {\n  getTasks: async () => {\n    const response = await axios.get(\"/api/items\");\n    return response.data;\n  },\n\n  getTaskById: async (id) => {\n    const response = await axios.get(`/api/items/${id}`);\n    return response.data;\n  },\n\n  addTask: async (name) => {\n    const newTask = { name, isComplete: false };\n    const response = await axios.post(\"/api/items\", newTask);\n    return response.data;\n  },\n\n  updateTask: async (id, name, isComplete) => {\n    const response = await axios.put(`/api/items/${id}`, { id, name, isComplete });\n    return response.data;\n  },\n\n  deleteTask: async (id) => {\n    const response = await axios.delete(`/api/items/${id}`);\n    return response.data;\n  },\n};\n\n// מייצאים את שני השירותים: auth ו־todo\nexport default { ...authService, ...todoService };\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACAA,KAAK,CAACC,QAAQ,CAACC,OAAO,GAAG,uBAAuB;;AAEhD;AACAF,KAAK,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EACzC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;EAC7C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,UAAUJ,KAAK,EAAE;EAClD;EACA,OAAOD,MAAM;AACf,CAAC,CAAC;;AAEF;AACAN,KAAK,CAACG,YAAY,CAACS,QAAQ,CAACP,GAAG,CAC5BO,QAAQ,IAAKA,QAAQ,EACrBC,KAAK,IAAK;EACT,IAAIA,KAAK,CAACD,QAAQ,IAAIC,KAAK,CAACD,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;IACnDC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACjC;EACA,OAAOC,OAAO,CAACC,MAAM,CAACN,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACA,MAAMO,WAAW,GAAG;EAClBC,QAAQ,EAAE,MAAAA,CAAOC,QAAQ,EAAEC,QAAQ,KAAK;IACtC,MAAMX,QAAQ,GAAG,MAAMZ,KAAK,CAACwB,IAAI,CAAC,oBAAoB,EAAE;MACtDF,QAAQ;MACRG,YAAY,EAAEF,QAAQ,CAAE;IAC1B,CAAC,CAAC;IACF,MAAM;MAAEhB;IAAM,CAAC,GAAGK,QAAQ,CAACc,IAAI;IAC/B,IAAInB,KAAK,EAAEC,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEpB,KAAK,CAAC;IAC/C,OAAOK,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDE,KAAK,EAAE,MAAAA,CAAON,QAAQ,EAAEC,QAAQ,KAAK;IACnC,MAAMX,QAAQ,GAAG,MAAMZ,KAAK,CAACwB,IAAI,CAAC,iBAAiB,EAAE;MACnDF,QAAQ;MACRG,YAAY,EAAEF;IAChB,CAAC,CAAC;IACF,MAAM;MAAEhB;IAAM,CAAC,GAAGK,QAAQ,CAACc,IAAI;IAC/B,IAAInB,KAAK,EAAEC,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEpB,KAAK,CAAC;IAC/C,OAAOK,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDG,MAAM,EAAEA,CAAA,KAAM;IACZrB,YAAY,CAACsB,UAAU,CAAC,OAAO,CAAC;EAClC;AACF,CAAC;;AAED;AACA,MAAMC,WAAW,GAAG;EAClBC,QAAQ,EAAE,MAAAA,CAAA,KAAY;IACpB,MAAMpB,QAAQ,GAAG,MAAMZ,KAAK,CAACiC,GAAG,CAAC,YAAY,CAAC;IAC9C,OAAOrB,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDQ,WAAW,EAAE,MAAOC,EAAE,IAAK;IACzB,MAAMvB,QAAQ,GAAG,MAAMZ,KAAK,CAACiC,GAAG,CAAC,cAAcE,EAAE,EAAE,CAAC;IACpD,OAAOvB,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDU,OAAO,EAAE,MAAOC,IAAI,IAAK;IACvB,MAAMC,OAAO,GAAG;MAAED,IAAI;MAAEE,UAAU,EAAE;IAAM,CAAC;IAC3C,MAAM3B,QAAQ,GAAG,MAAMZ,KAAK,CAACwB,IAAI,CAAC,YAAY,EAAEc,OAAO,CAAC;IACxD,OAAO1B,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDc,UAAU,EAAE,MAAAA,CAAOL,EAAE,EAAEE,IAAI,EAAEE,UAAU,KAAK;IAC1C,MAAM3B,QAAQ,GAAG,MAAMZ,KAAK,CAACyC,GAAG,CAAC,cAAcN,EAAE,EAAE,EAAE;MAAEA,EAAE;MAAEE,IAAI;MAAEE;IAAW,CAAC,CAAC;IAC9E,OAAO3B,QAAQ,CAACc,IAAI;EACtB,CAAC;EAEDgB,UAAU,EAAE,MAAOP,EAAE,IAAK;IACxB,MAAMvB,QAAQ,GAAG,MAAMZ,KAAK,CAAC2C,MAAM,CAAC,cAAcR,EAAE,EAAE,CAAC;IACvD,OAAOvB,QAAQ,CAACc,IAAI;EACtB;AACF,CAAC;;AAED;AACA,eAAe;EAAE,GAAGN,WAAW;EAAE,GAAGW;AAAY,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}